jQuery(document).ready(function(e){var d=e(this),c=e("body");var g={sortable:{axis:"y",start:function(j,k){k.placeholder.height(k.item.outerHeight())},stop:function(j,k){k.item.parent().kcReorder(k.item.data("mode"),true).children().each(function(){e("> details > summary > .actions .count",this).text(e(this).index()+1)})}},colorpicker:{onBeforeShow:function(){e(this).ColorPickerSetColor(this.value)},onSubmit:function(j,n,l,m){var k="#"+n;e(m).css({backgroundColor:k,color:invertColor(k)}).val(k).ColorPickerHide()}},datepicker:{date:{dateFormat:"yy-mm-dd",changeMonth:true,changeYear:true,showButtonPanel:true},month:{changeMonth:true,changeYear:true,showButtonPanel:true,dateFormat:"yy-mm",onClose:function(n,l){var j=e(l.dpDiv),m=j.find(".ui-datepicker-month :selected").val(),k=j.find(".ui-datepicker-year :selected").val();e(this).datepicker("setDate",new Date(k,m,1))}}}};e("#kc-settings-form").kcMetaboxDeps();e.kcRowCloner();e.kcRowCloner.addCallback("add",function(j){e("ul.kc-rows").sortable("refresh");e(".hasDatepicker",j.nuItem).each(function(){e(this).removeData("datepicker").removeClass("hasDatepicker").datepicker(g.datepicker[e(this).attr("type")])});e(".hasColorpicker",j.nuItem).each(function(){e(this).removeData("colorpickerId").removeAttr("style").ColorPicker(g.colorpicker)})});e("ul.kc-rows").sortable(g.sortable);e(".kcs-tabs").kcTabs();var a=e("input[type=date], input[type=month]");if(a.length&&Modernizr.inputtypes.date===false){var f=e("body").is(".admin-color-classic")?"cupertino":"flick";Modernizr.load([{load:win.kcSettings.paths.styles+"/jquery-ui/"+f+"/style.css",complete:function(){a.each(function(){e(this).datepicker(g.datepicker[e(this).attr("type")])})}}])}var i=e("input[type=color]");if(i.length&&Modernizr.inputtypes.color===false){Modernizr.load([{load:[win.kcSettings.paths.scripts+"/colorpicker/js/colorpicker.js",win.kcSettings.paths.scripts+"/colorpicker/css/colorpicker.css",win.kcSettings.paths.scripts+"/rgbcolor.js"],complete:function(){i.ColorPicker(g.colorpicker).each(function(){var j=e(this).addClass("hasColorpicker");if(j.val()!==""){j.css({backgroundColor:this.value,color:invertColor(this.value)})}})}}])}var h=e("#addtag");if(h.length){var b=e();e("div.kcs-field").each(function(){b=b.add(e(this).clone())});if(b.length){h.ajaxComplete(function(k,l,j){if(j.data.indexOf("action=add-tag")<0){return}e("div.kcs-field").each(function(m){e(this).replaceWith(b.eq(m).clone())});e(".kcs-tabs",h).kcTabs();h.trigger("kcsRefreshed")})}}});